یک پیچیدگی اضافی در به‌روزرسانی صفحات در محل این است که اگر چندین نخ (thread) قرار است همزمان به درخت B دسترسی داشته باشند، کنترل همروندی (concurrency control) دقیقی مورد نیاز است - در غیر این صورت، یک نخ ممکن است درخت را در حالت ناسازگار ببیند. این کار معمولاً با محافظت از ساختارهای داده درخت با قفل‌های سبک (latches) انجام می‌شود. رویکردهای مبتنی بر ساختار لاگ (log-structured) از این نظر ساده‌تر هستند، زیرا تمام ادغام‌ها را در پس‌زمینه بدون تداخل با پرس‌وجوهای ورودی انجام می‌دهند و هر از گاهی به صورت اتمیک قطعات قدیمی را با قطعات جدید جایگزین می‌کنند.

### بهینه‌سازی‌های درخت B

از آنجا که درخت‌های B مدت زمان طولانی است که وجود دارند، تعجب‌آور نیست که در طول سال‌ها بهینه‌سازی‌های زیادی برای آن‌ها توسعه یافته است. برای ذکر فقط چند مورد:

* به جای بازنویسی صفحات و نگهداری یک WAL (لاگ نوشتن-پیش) برای بازیابی از خرابی، برخی از پایگاه‌های داده (مانند LMDB) از طرح کپی-هنگام-نوشتن (copy-on-write) استفاده می‌کنند [[21](ch03.html#Chu2014we)]. یک صفحه اصلاح‌شده در مکان متفاوتی نوشته می‌شود و نسخه جدیدی از صفحات والد در درخت ایجاد می‌شود که به مکان جدید اشاره می‌کند. این رویکرد همچنین برای کنترل همروندی مفید است، همانطور که در ["ایزوله‌سازی اسنپ‌شات و خواندن تکرارپذیر"](ch07.html#sec_transactions_snapshot_isolation) خواهیم دید.% 