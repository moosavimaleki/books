### انواع داده و تکامل طرح‌واره

تغییر نوع داده یک فیلد چطور؟ این ممکن است امکان‌پذیر باشد—برای جزئیات مستندات را بررسی کنید—اما خطر از دست دادن دقت یا کوتاه شدن مقادیر وجود دارد. به عنوان مثال، فرض کنید یک عدد صحیح 32 بیتی را به یک عدد صحیح 64 بیتی تغییر می‌دهید. کد جدید می‌تواند به راحتی داده‌هایی را که توسط کد قدیمی نوشته شده است بخواند، زیرا تجزیه‌کننده می‌تواند هر بیت گمشده را با صفرها پر کند. با این حال، اگر کد قدیمی داده‌هایی را که توسط کد جدید نوشته شده است بخواند، کد قدیمی همچنان از یک متغیر 32 بیتی برای نگهداری مقدار استفاده می‌کند. اگر مقدار رمزگشایی شده 64 بیتی در 32 بیت جا نشود، کوتاه خواهد شد.

یک جزئیات جالب در مورد پروتکل بافرز این است که نوع داده لیست یا آرایه ندارد، بلکه به جای آن یک نشانگر تکراری (repeated) برای فیلدها دارد (که گزینه سومی در کنار الزامی و اختیاری است). همانطور که در [شکل 4-4](#fig_encoding_protobuf) می‌بینید، کدگذاری یک فیلد تکراری دقیقاً همان چیزی است که می‌گوید: همان برچسب فیلد به سادگی چندین بار در رکورد ظاهر می‌شود. این تأثیر خوبی دارد که تغییر یک فیلد اختیاری (تک مقداری) به یک فیلد تکراری (چند مقداری) مشکلی ندارد. کد جدید که داده‌های قدیمی را می‌خواند، یک لیست با صفر یا یک عنصر می‌بیند (بسته به اینکه آیا فیلد موجود بوده است)؛ کد قدیمی که داده‌های جدید را می‌خواند، فقط آخرین عنصر لیست را می‌بیند.