نگهداری یک ساختار مرتب شده روی دیسک ممکن است (به ["درخت‌های B"](#sec_storage_b_trees) مراجعه کنید)، اما نگهداری آن در حافظه بسیار آسان‌تر است. ساختارهای داده درختی شناخته شده زیادی وجود دارند که می‌توانید استفاده کنید، مانند درخت‌های قرمز-سیاه یا درخت‌های AVL [[2](ch03.html#Cormen2009uw)]. با این ساختارهای داده، می‌توانید کلیدها را در هر ترتیبی وارد کنید و آنها را به ترتیب مرتب شده بازخوانی کنید.

اکنون می‌توانیم موتور ذخیره‌سازی خود را به صورت زیر کار کنیم:

* وقتی یک نوشتن وارد می‌شود، آن را به یک ساختار داده درختی متعادل در حافظه (به عنوان مثال، یک درخت قرمز-سیاه) اضافه کنید. این درخت در حافظه گاهی اوقات memtable نامیده می‌شود.

* وقتی memtable از یک آستانه بزرگتر می‌شود—معمولاً چند مگابایت—آن را به عنوان یک فایل SSTable به دیسک بنویسید. این کار می‌تواند به طور کارآمد انجام شود زیرا درخت قبلاً جفت‌های کلید-مقدار را بر اساس کلید مرتب نگه می‌دارد. فایل SSTable جدید به جدیدترین قطعه پایگاه داده تبدیل می‌شود. در حالی که SSTable به دیسک نوشته می‌شود، نوشتن‌ها می‌توانند به یک نمونه memtable جدید ادامه یابند. 