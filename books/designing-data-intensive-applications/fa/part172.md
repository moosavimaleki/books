علاوه بر این، برخی عملیات نیاز به بازنویسی چندین صفحه مختلف دارند. به عنوان مثال، اگر به دلیل اضافه کردن یک مورد جدید که باعث پر شدن بیش از حد صفحه شده است، صفحه را تقسیم کنید، باید دو صفحه‌ای که تقسیم شده‌اند را بنویسید و همچنین صفحه والد آنها را برای به‌روزرسانی ارجاع‌ها به دو صفحه فرزند بازنویسی کنید. این یک عملیات خطرناک است، زیرا اگر پایگاه داده پس از نوشتن فقط برخی از صفحات دچار خرابی شود، با یک ایندکس فاسد مواجه می‌شوید (به عنوان مثال، ممکن است یک صفحه یتیم وجود داشته باشد که فرزند هیچ والدی نیست).

برای ایجاد مقاومت پایگاه داده در برابر خرابی‌ها، معمول است که پیاده‌سازی‌های B-tree شامل یک ساختار داده اضافی روی دیسک باشند: یک لاگ نوشتن-از-پیش (WAL، که به عنوان لاگ بازسازی نیز شناخته می‌شود). این یک فایل فقط-افزودنی است که هر تغییر B-tree باید قبل از اینکه بتواند روی صفحات خود درخت اعمال شود، در آن نوشته شود. هنگامی که پایگاه داده پس از یک خرابی دوباره راه‌اندازی می‌شود، از این لاگ برای بازگرداندن B-tree به یک وضعیت سازگار استفاده می‌شود [[5](ch03.html#Graefe2011kk)، [20](ch03.html#Mohan1992wo)].% 