![ddia 0303](assets/ddia_0303.png)
###### شکل 3-3. انجام فشرده‌سازی و ادغام قطعات به طور همزمان.

هر قطعه اکنون جدول هش در حافظه خود را دارد، که کلیدها را به آفست‌های فایل نگاشت می‌کند. برای یافتن مقدار یک کلید، ابتدا نقشه هش جدیدترین قطعه را بررسی می‌کنیم؛ اگر کلید موجود نباشد، دومین قطعه جدید را بررسی می‌کنیم، و به همین ترتیب. فرآیند ادغام تعداد قطعات را کم نگه می‌دارد، بنابراین جستجوها نیازی به بررسی بسیاری از نقشه‌های هش ندارند.

جزئیات زیادی برای عملی کردن این ایده ساده وجود دارد. به طور خلاصه، برخی از مسائلی که در یک پیاده‌سازی واقعی مهم هستند عبارتند از:

**فرمت فایل**
CSV بهترین فرمت برای یک لاگ نیست. استفاده از یک فرمت باینری که ابتدا طول یک رشته را در بایت کدگذاری می‌کند، و سپس رشته خام را (بدون نیاز به escape کردن) می‌آورد، سریع‌تر و ساده‌تر است.

**حذف رکوردها**
اگر می‌خواهید یک کلید و مقدار مرتبط با آن را حذف کنید، باید یک رکورد حذف ویژه را به فایل داده اضافه کنید (گاهی اوقات سنگ قبر نامیده می‌شود). هنگامی که قطعات لاگ ادغام می‌شوند، سنگ قبر به فرآیند ادغام می‌گوید که هر مقدار قبلی برای کلید حذف شده را دور بیندازد. 